<div class="row" xmlns="http://www.w3.org/1999/html">
  <div class="col-md-12">
    <h1>{{character.name}}</h1>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="dropdown">
      <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        {{text.getText().manageCharacterButton}}
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
        <li><a class="dropdown-item" style="cursor:pointer;"
               (click)="onAddToFight()">{{text.getText().addToFightButton}}</a></li>
        <li><a class="dropdown-item" style="cursor: pointer"
               (click)="onEditCharacter()">{{text.getText().editCharacterButton}}</a></li>
        <li><a class="dropdown-item" style="cursor: pointer"
               (click)="onDeleteCharacter()">{{text.getText().deleteCharacterButton}}</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <br>
    <h2>{{text.getText().descriptionLabel}}</h2>
    {{character.description}}
    <br>
    <br>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <br>
    <h2>{{text.getText().groupLabel}}</h2>
    {{character.group}}
    <br>
    <br>
  </div>
</div>

<hr>
<div class="row">
  <div class="col-md-12">
    <h2>{{text.getText().characteristicsLabel}}</h2>

    <table mat-table [dataSource]="[character]" class="mat-elevation-z8">
      <ng-container matColumnDef="{{column}}" *ngFor="let column of characteristicsColumns">
        <th mat-header-cell *matHeaderCellDef>{{text.getCharacteristicNameTranslation(column).nameTranslation}}</th>
        <td mat-cell *matCellDef="let element">{{element.getCharacteristic(column).value}}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="characteristicsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: characteristicsColumns;"></tr>
    </table>

  </div>
</div>

<ng-container *ngIf="character.notes.length > 0">
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h2>Notatki</h2>
      <ul class="list-group">
        <li class="list-group-item" *ngFor="let note of character.notes">
          {{note}}
        </li>
      </ul>
    </div>
  </div>
</ng-container>

<!--<hr>-->
<!--<div class="row">-->
<!--  <div class="col-md-12">-->
<!--    <h4>{{text.getText().primaryHandLabel}}</h4>-->
<!--    <h5 *ngIf="character.isRightHanded">- {{text.getText().rightHandLabel}}</h5>-->
<!--    <h5 *ngIf="!character.isRightHanded">- {{text.getText().leftHandLabel}}</h5>-->
<!--  </div>-->
<!--</div>-->

<hr>
<div class="row">
  <div class="col-md-12">
    <h2>{{text.getText().bodyLabel}}</h2>
    <table mat-table [dataSource]="character.bodyLocalizations" class="mat-elevation-z8">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>{{text.getText().nameLabel}}</th>
        <td mat-cell *matCellDef="let element"> {{element.bodyLocalization.nameTranslation}}</td>
      </ng-container>

      <ng-container matColumnDef="armorPoints">
        <th mat-header-cell *matHeaderCellDef>{{text.getText().armorPointsLabel}}</th>
        <td mat-cell *matCellDef="let element"> {{element.armorPoints}}</td>
      </ng-container>

      <ng-container matColumnDef="injuries">
        <th mat-header-cell *matHeaderCellDef>{{text.getText().injuriesLabel}}</th>
        <td mat-cell *matCellDef="let element">
          <ul>
            <li *ngFor="let characterInjury of element.injuries">
              <span *ngIf="characterInjury.value == 1">{{characterInjury.injury.nameTranslation}}</span>
              <span
                *ngIf="characterInjury.value > 1">{{characterInjury.injury.nameTranslation}} {{characterInjury.value}}</span>
            </li>
          </ul>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="bodyLocalizationsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: bodyLocalizationsColumns;"></tr>
    </table>
  </div>
</div>

<ng-container *ngIf="character.skills.length > 0 || character.talents.length > 0">
  <hr>
  <div class="row">
    <div class="row mb-3">
      <div class="col-md-5">
        <h2>{{text.getText().skillsLabel}}</h2>

        <table mat-table [dataSource]="character.skills" class="mat-elevation-z8">
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>{{text.getText().nameLabel}}</th>
            <td mat-cell *matCellDef="let element">
              {{element.skill.nameTranslation}}
            </td>
          </ng-container>

          <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef>{{text.getText().levelLabel}}</th>
            <td mat-cell *matCellDef="let element">
              {{element.value}}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="baseColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: baseColumns;"></tr>
        </table>
      </div>

      <div class="col-md-4">
        <h2>{{text.getText().talentsLabel}}</h2>

        <table mat-table [dataSource]="character.talents" class="mat-elevation-z8">
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>{{text.getText().nameLabel}}</th>
            <td mat-cell *matCellDef="let element">
              <span [matTooltip]="element.talent.description" matTooltipClass="custom-tooltip">
                {{element.talent.nameTranslation}}
              </span>
            </td>
          </ng-container>

          <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef>{{text.getText().levelLabel}}</th>
            <td mat-cell *matCellDef="let element">
              {{element.value}}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="baseColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: baseColumns;"></tr>
        </table>
      </div>

      <ng-container *ngIf="character.conditions.length > 0">
        <div class="col-md-3">
          <h2>{{text.getText().conditionsLabel}}</h2>
          <table mat-table [dataSource]="character.conditions" class="mat-elevation-z8">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>{{text.getText().nameLabel}}</th>
              <td mat-cell *matCellDef="let element">
                <span [matTooltip]="element.condition.description" matTooltipClass="custom-tooltip">
                  {{element.condition.nameTranslation}}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="level">
              <th mat-header-cell *matHeaderCellDef>{{text.getText().levelLabel}}</th>
              <td mat-cell *matCellDef="let element">
                {{element.value}}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="baseColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: baseColumns;"></tr>
          </table>

        </div>
      </ng-container>

    </div>
  </div>
</ng-container>

<ng-container *ngIf="character.weapons.length > 0">
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h2>{{text.getText().weaponLabel}}</h2>
      <table class="table table-bordered">
        <thead class="thead-dark">
        <tr>
          <th scope="col">{{text.getText().nameLabel}}</th>
          <th scope="col">{{text.getText().categoryLabel}}</th>
          <th scope="col">{{text.getText().reachLabel}}</th>
          <th scope="col">{{text.getText().damageLabel}}</th>
          <th scope="col">{{text.getText().advantagesAndDisadvantagesLabel}}</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let characterWeapon of character.weapons">
          <td
            *ngIf="characterWeapon.value == 1; else characterWeaponValue">{{characterWeapon.weapon.nameTranslation}}</td>
          <ng-template #characterWeaponValue>
            <td>{{characterWeapon.weapon.nameTranslation}} ({{characterWeapon.value}})</td>
          </ng-template>
          <td>{{characterWeapon.weapon.weaponGroupType.nameTranslation}}</td>
          <td>
          <span
            *ngIf="characterWeapon.weapon.weaponRange == 0; else weaponRange">{{characterWeapon.weapon.weaponReach.nameTranslation}}</span>
            <ng-template #weaponRange>
            <span *ngIf="characterWeapon.weapon.weaponGroupType.name.includes('AMMUNITION'); else fullWeaponRange">
              <span *ngIf="characterWeapon.weapon.weaponRange == 0.5">{{text.getText().halfWeaponRangeLabel}}</span>
              <span *ngIf="characterWeapon.weapon.weaponRange == 1">{{text.getText().rangeAsWeaponLabel}}</span>
              <span *ngIf="characterWeapon.weapon.weaponRange > 1">+{{characterWeapon.weapon.weaponRange}}</span>
            </span>
              <ng-template #fullWeaponRange>
                <span>{{characterWeapon.weapon.weaponRange}}</span>
              </ng-template>
            </ng-template>
          </td>
          <td>
          <span *ngIf="characterWeapon.weapon.isUsingStrength; else elseBlock">
            +{{+character.strength.value.toString()[0] + characterWeapon.weapon.damage}}
          </span>
            <ng-template #elseBlock>+{{characterWeapon.weapon.damage}}</ng-template>
          </td>
          <td>
            <ul>
              <li *ngFor="let quality of characterWeapon.weapon.weaponQualities">
                <span [matTooltip]="quality.description" matTooltipClass="custom-tooltip">
                  {{quality.nameTranslation}}
                </span>
              </li>
            </ul>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="character.armors.length > 0">
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h2>{{text.getText().armorLabel}}</h2>
      <table class="table table-bordered">
        <thead class="thead-dark">
        <tr>
          <th scope="col">{{text.getText().nameLabel}}</th>
          <th scope="col">{{text.getText().categoryLabel}}</th>
          <th scope="col">{{text.getText().localizationLabel}}</th>
          <th scope="col">{{text.getText().armorPointsLabel}}</th>
          <th scope="col">{{text.getText().penaltiesLabel}}</th>
          <th scope="col">{{text.getText().qualitiesLabel}}</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let armor of character.armors">
          <td>{{armor.nameTranslation}}</td>
          <td>{{armor.armorCategory.nameTranslation}}</td>
          <td>
            <ul>
              <li *ngFor="let localization of armor.armorBodyLocalizations">
                {{localization.bodyLocalization.nameTranslation}}
              </li>
            </ul>
          </td>
          <td>
            <ul>
              <li *ngFor="let localization of armor.armorBodyLocalizations">
                {{localization.armorPoints}}
              </li>
            </ul>
          </td>
          <td>
            <ul>
              <li *ngFor="let penalty of armor.armorPenalties">
                {{penalty.nameTranslation}}
              </li>
            </ul>
          </td>
          <td>
            <ul>
              <li *ngFor="let quality of armor.armorQualities">
                <span [matTooltip]="quality.description" matTooltipClass="custom-tooltip">
                  {{quality.nameTranslation}}
                </span>
              </li>
            </ul>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</ng-container>
